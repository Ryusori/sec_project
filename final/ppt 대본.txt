안녕하세요
2조 발표를 맡게된 장유선입니다.
저희 조는 머신러닝을 활용한 위치 기반 점포 관리 시스템을 주제로 프로젝트를 진행했는데요. 

자세한 설명은 다음과 같은 흐름으로 말씀드리겠습니다.

우선 기획 배경 및 목표입니다.
2014-2015년도는 마트와 같은 오프라인 점포들에게 힘든 시기였습니다. 배송 전쟁의 본격화로 인해 온라인 매출이 급증하면서 자연스럽게 오프라인 점포들은 매출 감소로 이어졌습니다. 또한, 심화된 경쟁으로 인해 오프라인 점포들은 변하지 않으면 살아남기 힘든 시기였습니다.  이에 저희 조는 점포에 초점을 두고 데이터를 분석해보고싶었습니다.

우선 점포의 위치를 파악해보고자 했습니다. 하지만, L사 데이터에서 위치를 알 수 있는 데이터는 고객의 거주지역이었기 때문에 점포의 위치를 유추해볼 수 밖에 없었습니다. 또한, 서울이 아닌 다른 거주지역은 시단위와 군단위의 고객수가 동일하게 나오더라구요. 예를 들어서 부산광역시 차원에서의 고객 수 count와 기장군의 고객 수 count를 비교해보았을 때 동일하게 나왔습니다. 따라서 저희 조는 서울특별시로 점포 위치를 제한하고 깔떼기 같이 거르고 거르는 방식으로 점포의 위치를 추정했습니다. 우선 서울특별시에 거주하는 고객이 가장 많이 이용한 점포를 우선 추렸습니다. 이 때 168개의 점포로 우선 추려졌습니다. 그리고 1차로 추린 168개의 점포들 각각의 고객의 최다 거주지역 top3를 뽑았습니다. 그리고 top3에 서울지역이 아닌 다른 거주지역이 있는 경우는 제외하여 최종적으로 163개의 점포를 서울의 구단위로 추정하였습니다. 

다음으로 매출 관련 데이터를 살펴보았습니다. 하지만 전체 데이터는 2014년 대비 2015년도에 증가했고, 문제점을 찾기위해서는 좀 더 구체화하여 매출을 분석할 필요가 있었습니다. 그래서 앞서 추정한 점포의 구마다 각 품목별 매출의 증감율이 어떤지 분석해보게 되었습니다. 서울 자치구의 수는 25개인데 해당 테이블에서 보시다시피 대부분의 품목에서 약 절반 정도의 자치구에서 매출이 감소하고있음을 알 수 있었습니다. 그렇다면 점포 차원에서 품목별 매출의 증감은 어떻게 변화하고 있었을까요?

점포 규모에서 품목별 증감율을 살펴본 결과, 대부분의 항목에서 해당 상품을 취급하는 점포 중 절반 정도가 매출이 감소하고 있음을 확인할 수 있었습니다. 이 결과를 보고 저희는 크게 4가지 질문이 떠올랐습니다. 점포마다 이렇게 매출이 감소했는데, 
그렇다면 점포의 위치는 적절했던걸까?
각 점포에 맞는 고객 타겟층을 설정한건가?
주 고객층의 수요를 정확하게 파악한걸까?
각 점포마다 다른 수요에 맞게 상품 구색이 이뤄진걸까?
그리고 이 4(네) 질문의 공통점이자 시작을 점포의 위치라고 생각했습니다. 마트와 같은 점포의 주요 고객들은 해당 점포 근처의 지역 주민들이 될 것입니다. 그렇다면 지역 주민들의 인구 특성에 맞는 수요를 파악하고 이에 맞는 공급과 마케팅 등이 이뤄져야하기 때문입니다. 

인구가 감소하는 지역에 새로운 점포를 오픈하게 된다면 매출이 증가할가요? 오프라인 점포의 생존 방법 중 하나로 고객 체험이 키워드로 떠오르고 있는 시기에 노령 인구가 많은 지역에 유아용품 체험 공간을 기획한다면 매출이 증가할 수 있을까요? 저희는 위와 같은 문제 방지를 위해 위치 및 해당 거주 인구 특성에 기반한 점포 관리 시스템을 개발을 목표로 삼게되었습니다.

우선 저희가 생각하는 시스템의 기대효과는 다음과 같습니다. 폐점 및 관리가 필요한 점포의 후보를 선정하고 점포의 상품 구성을 관리하는 과정이 쉬워지면서 위치 및 상품 관련 점포관리가 효율적으로 이워질 수 있을 거라고 생각합니다.

저희는 목표로하는 시스템을 개발하기위해 데이터 전처리, 분류, 군집화 프로세스를 거쳐서 솔루션과 점포 운영 여부 권유까지의 흐름으로 진행해보았습니다.

우선 데이터 수집 및 전처리 과정입니다.
저희 조는 점포의 위치를 추정했고 해당 위치의 인구 특성을 반영한 솔루션을 도출하기 위해서 외부 데이터를 사용했습니다. 각 구마다의 1인가구수, 외국인 수, 문화공간 수, 학교 수 등을 파악할 수 있었습니다. 

그리고 L사 데이터의 상품 분류가 제휴사 마다 제각각이었기 때문에 이를 통일했는데요. 신선식품, 가공식품으로 식품을 크게 나누었고, 일상용품, 유아용품, 교육/문화, 디지털/가전 등의 대분류와 각각의 중분류는 다양한 상품을 포괄적으로 묶을 수 있으면서도 세부적인 데이터를 알 수 있는 그 중간 지점을 찾아서 분류했습니다. 

다음으로 저희는 분류 feature 개발을 위해 필수재와 사치재도 구분했는데요. 지금 슬라이드에서 보시는 것처럼 필수재에는 식품, 생활용픔, 옷 등이 있고, 사치재에는 명품, 가전, 교육/문화/스포츠 등의 품목이 있습니다. 

다음 과정으로 저희는 앞에서 전처리한 데이터와 외부에서 수집한 데이터들을 기반으로 분류를 위한 feature들을 개발했습니다. 이 때 크게 상품 및 매출 관련 피처, 고객 관련 피쳐, 지역 관련 피쳐로 크게 나누어서 진행했습니다.

분류를 위한 test와 train 데이터를 어떻게 설정했는지 설명드리자면, 우선 2014년도에서 2015년도 사이를 8분기로 나눠 1분기부터 7분기를 train 데이터셋으로, 2~8분기를 val_test 데이터 셋으로 만들었습니다. 이 때, train data set에서 1에서 6분기 사이의 변화를 train data로 7분기 데이터를 label로 두었고 val_test data set도 비슷하게 2에서 7분기 사이의 변화를 val_test data로 8분기를 label로 두어 분류를 진행했습니다. 매출이 증가한 점포는 train data set에 좀 더 많이 있었습니다. 

분류를 진행할 때 힘들었던 점은 feature importance가 계속 0으로 나오는 피처들이 많았던 것입니다. 원인을 찾다가 이는 숫자들의 크기가 너무 제각각이기 때문이라는 것을 알게되었고, 필요한 feature들은 등급화를 진행했습니다. 우측 하단에 보이는 그래프는 점포의 분기별 평균 구매액을 등급화하고 각 등급의 분포를 살펴본 그래프입니다. 

다음은 모델링 및 분석입니다.
우선 Pycaret으로 분류 모델 Top3를 추린 후, 평가 지표를 비교했는데요. 그 중 F1 score가 가장 높은 Random Forest를 선택하여 feature importance를 확인하여 피처를 추린 뒤 분류를 진행했습니다. 

그 결과 매출이 감소할 것으로 예상되는 점포는 86개, 매출이 증가할 것으로 예상되는 점포는 77개로 분류된 것을 확인할 수 있었습니다. 이렇게 분류된 점포들을 앞서 선택한 feature들과 지역 관련 외부 데이터를 사용해 매출 증가 예측 점포와 감소 예측 점포끼리 각각 군집화를 진행했습니다.

우선 매출이 증가할 것으로 예상되는 점포들의 군집화 과정입니다. 이 때 실루엣 계수, elbow 기법, 실제 분포 그래프 등을 종합적으로 고려하여 군집 개수를 정했고 총 4개의 군집으로 나누었습니다. 

매출이 감소할 것으로 예상되는 점포 86개도 같은 방법으로 4개의 군집으로 군집화를 진행했습니다.

이 때, Decision Tree를 사용해서 어떤 기준으로 군집화가 되었는지를 파악해보았고, 이 기준들을 통해서 각 군집의 특성을 파악할 수 있었습니다. 

GridSearchCV를 통해 최적 하이퍼파라미터를 적용하여 군집화 Decision Tree도 그려보았는데 점포들을 군집화하다보니 데이터 수가 적어서 그런지 생각보다 군집이 잘 되지 않아 앞에서 말씀드린 방법을 사용하여 최종적으로 증가 감소 점포 모두 4개의 군집으로 군집화를 진행했습니다.

최종 군집과 각 군집의 특성을 정리해보았습니다. 신기하게도 증가 예측 점포(increase) 점포와 감소 예측 점포(decrease) 모두 두 개의 군집은 지역 인구 특성과 관련된 군집이었고, 나머지 두 개는 상품과 관련된 군집이었습니다. 제품 관련 군집은 제품 관련 군집끼리, 인구 특성 관련 군집은 인구 특성 관련 군집끼리 살펴보았는데요. 우선 인구 특성 관련 군집에는 increase 0, 2 / decrease 1, 3 군집이 있습니다. 그 중 주 고객층이 해당 구의 최다 거주 연령층인 군집과 그렇지 않은 군집에 집중했습니다. 같은 구에 있는데 어떤 매장은 구 고객층이 지역 주민이고 다른 매장은 그렇지 않아 매출이 감소한다면 해당 점포에는 이와 관련된 해결책이 필요하기 때문입니다. 그리고 decrease 점포 군집 2번에 집중하여 필수재 구입이 줄어드는 경향의 원인을 파악하고 이에 대한 솔루션을 생각해보고자 했습니다. 

우선 increase 0과 decrease 3 군집 관련 솔루션 제시입니다. 우선 매출이 감소해 상품 관리가 필요하다고 생각되는 점포를 입력합니다. 그러면 입력 점포의 매출이 증가했는지 감소했는지를 일단 확인합니다. 해당 점포의 매출이 감소되었을 때, 입력 점포와 같은 지역구인 점포 중 매출이 증가한 점포가 있는지를 확인합니다. 그리고 해당 점포의 제휴사가 입력한 점포와 동일한지까지 확인하여 비교 대상을 선정합니다. 

다음은 선정된 비교 대상들의 상품 분류를 비교하는 과정입니다. 매출이 증가한 점포의 중분류 TOP 10 중 입력 점포의 TOP10에 없는 중분류를 관리가 필요한 대상으로 선정했습니다. 그 이유는, 같은 구에 있으면 인구 특성이 비슷하다고 추측할 수 있는데, 그렇다면 매출이 증가한 점포와 상품 구성이 어느 정도 비슷해야 해당 지역 주민 즉 주 고객층의 수요를 반영한 상품 구색을 갖췄다라고 생각할 수 있기 때문입니다. 그렇게 관리가 필요한 중분류를 설정하고 매출 증가 점포와 비교했을 때 입력 점포에는 없는 상품 소분류를 매출 순서대로 최대 10개 상품을 추천합니다.

마지막으로는 상품 추천 리스트를 추출해 결과를 보여줍니다. 위에는 비교가 가능한 매장이 있는 입력 점포의 결과물입니다. 설명드린대로 우선 점포의 매출의 증감을 확인하고, 비교 가능한 점포를 추린 뒤, 중분류 그리고 소분류 순서대로 리스트를 추려서 추천해줍니다. 
아래에는 비교 가능한 매장이 없는 경우입니다. 

하지만, 이렇게 중분류 내에서 소분류가 매출이 증가한 점포와 같은 매출감소 점포도 있는데요. 이에 대한 솔루션은 크게 두 가지를 생각해볼 수 있습니다. 우선 첫 번째로 소분류(품목)의 재고 관리가 부족한 경우입니다. 상품 구성은 적절하지만, 재고가 부족해 고객들이 사고자해도 살 수 없는 경우가 있을 수 있죠. 즉, 재고가 고객들의 수요보다 부족하지는 않은지, 그리고 상품의 dp는 잘 되고 있는지 등을 확인해볼 수 있습니다. 두 번째는 해당 점포의 상품 구색이 아닌 다른 외부 요인으로 인해 매출이 감소하고 있을 수 있습니다. 이 때에는 해당 외부 요인이 무엇인지를 파악하는 일에 집중하여 솔루션을 내는 것이 중요합니다. 물론 저희가 개발하는 시스템은 외부 요인이 무엇인지 까지는 보여주지 못합니다. 하지만, 이러한 경우에는 해당 시스템을 이용해보고 상품 관련된 문제는 아니구나하고 후보 요인들 중 하나를 지우는 과정을 빠르고 쉽게 만들어주는 데에도 도움이 된다고 생각합니다. 

다음은 상품 특성과 관련된 군집과 관련된 솔루션입니다. 앞서 말씀드린대로 Decrease 2번의 필수재 구입이 줄어드는 경향이 있는 군집에 대한 내용인데요. 우선 매출이 감소한 점포 중 상품 특성으로 군집된 점포를 확인합니다. 그리고 확인한 점포들과 increase 점포 전체를 벡터화합니다. 벡터화 한 값을 이용해 코사인 유사도를 구하고, 코사인 유사도가 높은 점포들을 확인합니다. 확인한 결과 신기하게도 같은 군집화 유형으로 묶은 점포들은 코사인 유사도 TOP3가 모두 유사하게 나왔습니다.

그 중 감소 점포 B10에 집중하여 자세히 설명드리겠습니다. 앞에서 B10은 광진구의 C478, 서대문구의 B9, 노원구의 C127 점포와 코사인 유사도가 가장 높게 나왔는데요. 이 두 그룹을 품목 및 해당 지역 인구 특성 관점으로 분석을 진행했습니다. 그 결과 B10 점포는 영유아가 많은 지역에 위치해 있어 유아 관련 물품이 많이 팔리지만, 영유아 수가 점차 줄어듦으로 인해 필수재의 구입이 줄어드는 것으로 보여 이에 대비하여 영유아 관련 물품을 줄이고, 가공식품 중심의 상품 구색을 갖출 필요가 있다는 결론을 냈습니다. 

다음으로 B13 점포입니다. B13점포는 광진구의 C478, 서대문구의 B9, 노원구의 C127 점포와 코사인 유사도가 가장 높았습니다. 분석 결과 B13 점포는 영유아식품, 의류, 커피/차류, 수산물의 판매 비중이 높은 것으로 확인되었고, 매출이 증가한 점포에서 잘 할리는 상품 중 시너지 효과를 낼 수 있는 상품을 함께 dp할 수 있도록 하는 솔루션을 낼 수 있습니다. 맥주와 기저귀처럼 농산물/축산물/수산물과 주류를 비슷한 곳에, 커피/차류와 빵/떡류를 비슷한 곳에 dp한다면 매출 증진에 도움이 될 것입니다. 


마지막 결론입니다.

우선 첫 번째 솔루션으로 말씀드렸던 상품 추천을 C532 점포에 적용해보았을 때 11%의 매출이 증가하는 것을 볼 수 있었습니다. 이를 통해 상품 관련 관리가 필요한 점포에는 해당 솔루션이 효과가 있다는 것을 확인할 수 있었습니다.

저희 조의 최종 솔루션 제안입니다.
우선 매출이 감소할 것으로 예상되는 점포들을 예측합니다. 그리고 이들을 인구 특성과 관련된 군집과 상품 특성과 관련된 군집으로 나눕니다. 인구 특성과 관련된 군집으로 묶인 매출 감소 점포들은 같은 자치구 내에 매출이 증가한 점포가 있는 지를 확인하고 비교할 점포가 있다면 품목을 대분류에서 소분류로 세분화하면서 비교해 상품을 추천합니다. 하지만, 만약 상품에는 문제가 없다면 해당 중분류의 dp가 잘 이루어지고 있는지 상품이 아닌 다른 외부 요인이 원인은 아닌지 살펴봅니다. 
두 번째로 상품 특성으로 묶인 군집은 상품의 특정 사위 카테고리 매출이 점차 증감하는 추세의 군집으로 감소 점포와 증가 점포의 코사인 유사도를 측정하고 코사인 유사도가 높은 점포와 비교해 매출을 분석하고 매출의 증감 요인을 찾아 맞춤 솔루션을 도출하는 것입니다.

사실 이렇게만 된다면 너무 좋겠지만, 개선이 필요한 부분들도 많이 있습니다. 우선 저희는 점포의 위치가 중요하다고 강조했지만, 지금 L사의 데이터로 점포의 정확한 위치를 추정하기 어렵다는 것입니다. 구 단위로만 위치를 추정할 수 있었는데 이는 구체적인 지역 인구 특성을 파악하기는 어려움이 많습니다. 하지만, 기업 입장에서는 점포의 자세한 위치를 알기 때문에 이는 쉽게 해결될 수 있다고 생각합니다.
두 번째 한계점은 위치와 매출 사이의 관계성이 떨어질 수 있다는 점입니다. 백화점은 차량을 이용한 고객들이 많다보니 위치와 점포 매출 사이의 관계성이 떨어질 수 있습니다. 
세 번째, 매출이 증가한 점포와 감소한 점포의 상품 구성에 큰 차이가 없을 수도 있습니다. 앞에서 설명드린 것처럼 상품 구성에는 별 차이가 없는데 매출이 감소한 점포들이 있죠. 이들은 상품이 아닌 다른 요인을 찾아봐야할 수도 있습니다. 
마지막으로, 매출 감소의 원인 중에는 데이터에서 찾을 수 없는 불명확안 요인들도 많다는 점입니다. 직원의 불친절한 서비스나 점포의 청결 상태 등 점포의 매출을 결정하는 요소들은 너무나도 복잡하고 많은 요소들이 있습니다. 
하지만, 저희가 도출한 솔루션을 이용한다면 다양한 요인들을 하나씩 제거해나가는 데 도움이 될 수 있다고 생각합니다. 더 나아가 점포와 관련된 더 자세한 데이터를 사용해 feature를 만들어 분류 및 군집화를 한다면 이러한 복잡한 요인들을 고려한 솔루션을 낼 수 있다고 생각합니다. 저희 조 발표는 여기까지 입니다. 감사합니다. 

질문 있으시면 질문해주세요.

